var V_permission_name = [
	"Data_Use_Base_0_1",
	"Data_Use_Base_0_1",
	"Data_Use_Base_0_2",
	"Data_Use_Base_0_3",
	"Data_Use_Base_0_4",
	"Data_Use_Base_0_5",
	"Data_Use_Base_0_6",
	"Data_Use_Base_0_7",
	"Data_Use_Base_0_8",
	"Data_Use_Base_0_9",
	"Data_Use_Base_0_11",
	"Data_Use_Base_0_12",
	"Data_Use_Base_0_13",
	"Data_Use_Base_1_1",
	"Data_Use_Base_1_1",
	"Data_Use_Base_1_2",
	"Data_Use_Base_1_3",
	"Data_Use_Base_1_4",
	"Data_Use_Base_1_5",
	"Data_Use_Base_1_6",
	"Data_Use_Base_1_7",
	"Data_Use_Base_1_8",
	"Data_Use_Base_1_9",
	"Data_Use_Base_1_10",
	"Data_Use_Base_1_11",
	"Data_Use_Base_2_0",
	"Data_Use_Base_3_0",
	"Data_Use_Base_3_2",
	"Data_Use_Model_1_0",
	"Data_Use_Model_1_1",
	"Data_Use_Model_1_11",
	"Data_Use_Model_1_2",
	"Data_Use_Model_1_3",
	"Data_Use_Model_1_4",
	"Data_Use_Model_1_HECRAS",
	"Data_Use_Model_1_DFMfGT",
	"Data_Use_Project_1_0",
	"Data_Use_Project_1_1",
	"Data_Use_Project_1_2",
	"Data_Use_Project_1_3",
	"Data_Use_Project_1_4",
	"Data_Use_Project_1_5",
	"Data_Use_Project_1_6",
	"Data_Use_Project_1_7",
	"Data_Use_LandslideDam_1_0",
	"Func_Use_Sup_1_1",
	"Func_Use_Sup_1_2",
	"Func_Use_Sup_1_3",
	"Func_Use_Sup_1_4",
	"Func_Use_Land_1_1",
	"Func_Use_Land_1_2",
	"Func_Use_Land_1_3",
	"Func_Use_Land_1_4",
	"Func_Use_Model_1_1",
	"Func_Use_Model_1_2",
	"Func_Use_Model_1_3",
	"Func_Use_Analysis_1_1",
	"Func_Use_Analysis_1_2",
	"Func_Use_Analysis_1_3",
	"Func_Use_Analysis_1_4",
	"Func_Use_Analysis_1_5",
	"Func_Use_Analysis_1_6",
	"Func_Use_Analysis_1_7",
	"Func_Use_Analysis_1_8",
	"Func_Use_Analysis_1_9",
	"Func_Use_Draw_1_1",
	"Func_Use_Draw_1_2",
	"Func_Use_Draw_1_3",
	"Func_Use_Share_1_1",
	"Func_Use_Share_1_2",
	"Func_Use_Share_1_4",
	"Func_Use_Share_1_5",
	"Func_Use_Location_1_1",
	"Func_Use_Location_1_3",
	"Func_Use_Location_1_4",
	"Func_Use_Location_1_5",
	"Func_Use_Location_1_6",
	"Func_Use_Location_1_7",
	"Func_Use_Location_1_8",
	"Func_Use_Manage_1_1",
	"Func_Use_Data_1_1",
	"Func_Use_Data_1_2",
	"Data_Download_Base_1_2",
	"Data_Download_Base_1_3",
	"Data_Download_Base_1_4",
	"Data_Download_Base_2_0",
	"Data_Download_Base_3_0",
	"Data_Download_Project_1_1",
	"Data_Download_Project_1_2",
	"Data_Download_Project_1_3",
	"Data_Download_Project_1_4",
	"Data_Download_Project_1_5",
	"Data_Download_Project_1_6",
	"Data_Download_Project_1_7"
];
var V_permission = {
	Data_Use_Base_0_0: 1,
	Data_Use_Base_0_1: 1,
	Data_Use_Base_0_2: 0,
	Data_Use_Base_0_3: 1,
	Data_Use_Base_0_4: 1,
	Data_Use_Base_0_5: 1,
	Data_Use_Base_0_6: 1,
	Data_Use_Base_0_7: 1,
	Data_Use_Base_0_8: 1,
	Data_Use_Base_0_9: 1,
	Data_Use_Base_0_11: 1,
	Data_Use_Base_0_12: 1,
	Data_Use_Base_0_13: 1,
	Data_Use_Base_1_0: 1,
	Data_Use_Base_1_1: 1,
	Data_Use_Base_1_2: 1,
	Data_Use_Base_1_3: 1,
	Data_Use_Base_1_4: 1,
	Data_Use_Base_1_5: 1,
	Data_Use_Base_1_6: 1,
	Data_Use_Base_1_7: 0,
	Data_Use_Base_1_8: 0,
	Data_Use_Base_1_9: 1,
	Data_Use_Base_1_10: 1,
	Data_Use_Base_1_11: 0,
	Data_Use_Base_2_0: 1,
	Data_Use_Base_3_0: 1,
	Data_Use_Base_3_2: 1,
	Data_Use_Model_1_0: 1,
	Data_Use_Model_1_1: 0,
	Data_Use_Model_1_11: 1,
	Data_Use_Model_1_2: 1,
	Data_Use_Model_1_3: 0,
	Data_Use_Model_1_4: 0,
	Data_Use_Model_1_HECRAS:0,
	Data_Use_Model_1_DFMfGT:0,
	Data_Use_Project_1_0: 0,
	Data_Use_Project_1_1: 0,
	Data_Use_Project_1_2: 0,
	Data_Use_Project_1_3: 0,
	Data_Use_Project_1_4: 0,
	Data_Use_Project_1_5: 0,
	Data_Use_Project_1_6: 0,
	Data_Use_Project_1_7: 0,
	Data_Use_LandslideDam_1_0: 0,
	Func_Use_Sup_1_1: 1,
	Func_Use_Sup_1_2: 1,
	Func_Use_Sup_1_3: 1,
	Func_Use_Sup_1_4: 1,
	Func_Use_Land_1_1: 1,
	Func_Use_Land_1_2: 1,
	Func_Use_Land_1_3: 1,
	Func_Use_Land_1_4: 1,
	Func_Use_Model_1_1:1,
	Func_Use_Model_1_2:0,
	Func_Use_Model_1_3:0,
	Func_Use_Analysis_1_1: 1,
	Func_Use_Analysis_1_2: 1,
	Func_Use_Analysis_1_3: 1,
	Func_Use_Analysis_1_4: 1,
	Func_Use_Analysis_1_5: 1,
	Func_Use_Analysis_1_6: 1,
	Func_Use_Analysis_1_7: 1,
	Func_Use_Analysis_1_8: 1,
	Func_Use_Analysis_1_9: 1,
	Func_Use_Draw_1_1: 1,
	Func_Use_Draw_1_2: 1,
	Func_Use_Draw_1_3: 1,

	Func_Use_Share_1_1: 0,
	Func_Use_Share_1_2: 0,
	Func_Use_Share_1_4: 0,
	Func_Use_Share_1_5: 0,
	Func_Use_Location_1_1: 1,
	Func_Use_Location_1_3: 1,
	Func_Use_Location_1_4: 1,
	Func_Use_Location_1_5: 1,
	Func_Use_Location_1_6: 1,
	Func_Use_Location_1_7: 1,
	Func_Use_Location_1_8: 1,
	Func_Use_Manage_1_1: 0,
	Func_Use_Data_1_1: 1,
	Func_Use_Data_1_2: 0,
	Data_Download_Base_1_2: 0,
	Data_Download_Base_1_3: 0,
	Data_Download_Base_1_4: 0,
	Data_Download_Base_2_0: 0,
	Data_Download_Base_3_0: 0,
	Data_Download_Project_1_1: 0,
	Data_Download_Project_1_2: 0,
	Data_Download_Project_1_3: 0,
	Data_Download_Project_1_4: 0,
	Data_Download_Project_1_5: 0,
	Data_Download_Project_1_6: 0,
	Data_Download_Project_1_7: 0
}

//permission_pass=[];
function login_permission_set(roles) {

	for (i = 0; i < V_permission_name.length; i++) {
		V_permission[V_permission_name[i]] = 0;
	}
	//permissions_array=roles[0].permissions;

	//alert("roles大小："+permissions_array.length);
	for (k = 0; k < roles.length; k++) {
		permissions_array = roles[k].permissions;
		for (j = 0; j < permissions_array.length; j++) {
			V_permission[permissions_array[j].slug] = 1;
		}
		//V_permission['Func_Use_Share_1_5'] = 1
	}

	permission_set();
}
//alert(V_permission["Func_Use_Analysis_1_1"]);
function permission_set() {
 
	if (V_permission["Func_Use_Data_1_1"] == 0) { $("#data_search").hide(); } else { $("#data_search").show(); }
	//Baselayer_w1.show();
	// Baselayer_w1_Acc_C00_call(1);Baselayer_w1_Acc_00_call(0); Baselayer_w1_Acc_01_call(0); Baselayer_w1_Acc_02_call(0); Baselayer_w1_Acc_03_call(0);
	//Baselayer_w1_Acc_00_call(0); Baselayer_w1_Acc_01_call(0); Baselayer_w1_Acc_02_call(0); Baselayer_w1_Acc_03_call(0); Baselayer_w1_Acc_00_call(1); Baselayer_w1_Acc.cells('a0_0').open();
	//Baselayer_w1.hide();
	Model_w1.show();
	if (V_permission["Data_Use_Model_1_0"] == 0) { Model_w1_Acc_01.cells("a0").hide(); } else { Model_w1_Acc_01.cells("a0").show(); }
	if (V_permission["Data_Use_Model_1_1"] == 0) { Model_w1_Acc_01.cells("a1").hide(); } else { Model_w1_Acc_01.cells("a1").show(); }
	if (V_permission["Data_Use_Model_1_11"] == 0) { Model_w1_Acc_01.cells("a11").hide(); } else { Model_w1_Acc_01.cells("a11").show(); }
	if (V_permission["Data_Use_Model_1_2"] == 0) { Model_w1_Acc_01.cells("a2").hide(); } else { Model_w1_Acc_01.cells("a2").show(); }
	if (V_permission["Data_Use_Model_1_3"] == 0) { Model_w1_Acc_01.cells("a3").hide(); } else { Model_w1_Acc_01.cells("a3").show(); }
	if (V_permission["Data_Use_Model_1_HECRAS"] == 0) { Model_w1_Acc_01.cells("HECRAS").hide(); } else { Model_w1_Acc_01.cells("HECRAS").show(); }
	if (V_permission["Data_Use_Model_1_DFMfGT"] == 0) { Model_w1_Acc_01.cells("DFMfGT").hide(); } else { Model_w1_Acc_01.cells("DFMfGT").show(); }
	
	Model_w1.hide();
	Project_w1.show();
	if (V_permission["Data_Use_Project_1_0"] == 0) { $("#project_win_id").hide(); } else { $("#project_win_id").show(); }
	if (V_permission["Data_Use_Project_1_1"] == 0) { Project_w1_Acc.cells("a1").hide(); } else { Project_w1_Acc.cells("a1").show(); }
	if (V_permission["Data_Use_Project_1_2"] == 0) { Project_w1_Acc.cells("a2").hide(); } else { Project_w1_Acc.cells("a2").show(); }
	if (V_permission["Data_Use_Project_1_3"] == 0) { Project_w1_Acc.cells("a3").hide(); } else { Project_w1_Acc.cells("a3").show(); }
	if (V_permission["Data_Use_Project_1_4"] == 0) { Project_w1_Acc.cells("a4").hide(); } else { Project_w1_Acc.cells("a4").show(); }
	if (V_permission["Data_Use_Project_1_5"] == 0) { Project_w1_Acc.cells("a5").hide(); } else { Project_w1_Acc.cells("a5").show(); }
	if (V_permission["Data_Use_Project_1_6"] == 0) { Project_w1_Acc.cells("a6").hide(); } else { Project_w1_Acc.cells("a6").show(); }
	if (V_permission["Data_Use_Project_1_7"] == 0) { Project_w1_Acc.cells("a7").hide(); } else { Project_w1_Acc.cells("a7").show(); }
	Project_w1.hide();
	Landslidedam_w1.show();
	Landslidedam_w1_Acc_00_call(0); Landslidedam_w1_Acc_01_call(0);/*Landslidedam_w1_Acc_02_call(0);*/Landslidedam_w1_Acc_03_call(0); Landslidedam_w1_Acc_00_call(1); Landslidedam_w1_Acc.cells('a0_0').open();
	console.log("check log in");
	if (V_permission["Data_Use_LandslideDam_1_0"] == 0) { console.log("not log in"); $("#landslidedam").hide();  } else { console.log("log in"); $("#landslidedam").show(); }
	Landslidedam_w1.hide();
	if (V_permission["Data_Use_Base_1_11"] == 0) { console.log("not log in"); $('#planet_checkbox').attr("style", "display:none;"); } else { console.log("log in"); $('#planet_checkbox').attr("style", ""); }
	
	if (V_permission["Func_Use_Sup_1_1"] == 0) { $('#Sup_1_1').attr("style", "display:none;"); } else { $('#Sup_1_1').attr("style", ""); }
	if (V_permission["Func_Use_Sup_1_2"] == 0) { $('#Sup_1_2').attr("style", "display:none;"); } else { $('#Sup_1_2').attr("style", ""); }
	if (V_permission["Func_Use_Sup_1_3"] == 0) { $('#Sup_1_3').attr("style", "display:none;"); } else { $('#Sup_1_3').attr("style", ""); }
	if (V_permission["Func_Use_Sup_1_4"] == 0) { $('#Sup_1_4').attr("style", "display:none;"); } else { $('#Sup_1_4').attr("style", ""); }
	if (V_permission["Func_Use_Land_1_1"] == 0) { $('#Land_1_1').attr("style", "display:none;"); } else { $('#Land_1_1').attr("style", ""); }
	if (V_permission["Func_Use_Land_1_2"] == 0) { $('#Land_1_2').attr("style", "display:none;"); } else { $('#Land_1_2').attr("style", ""); }
	if (V_permission["Func_Use_Land_1_3"] == 0) { $('#Land_1_3').attr("style", "display:none;"); } else { $('#Land_1_3').attr("style", ""); }
	if (V_permission["Func_Use_Land_1_4"] == 0) { $('#Land_1_4').attr("style", "display:none;"); } else { $('#Land_1_4').attr("style", ""); }
	if (V_permission["Func_Use_Model_1_1"] == 0) { $('#Model_1_1').attr("style", "display:none;"); } else { $('#Model_1_1').attr("style", ""); }
	if (V_permission["Func_Use_Model_1_2"] == 0) { $('#Func_Use_Model_1_2').attr("style", "display:none;"); } else { $('#Func_Use_Model_1_2').attr("style", ""); }
	//if (V_permission["Func_Use_Model_1_3"] == 0) { $('#Model_1_3').attr("style", "display:none;"); } else { $('#Model_1_3').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_1"] == 0) { $('#Analysis_1_1').attr("style", "display:none;"); } else { $('#Analysis_1_1').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_2"] == 0) { $('#Analysis_1_2').attr("style", "display:none;"); } else { $('#Analysis_1_2').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_3"] == 0) { $('#Analysis_1_3').attr("style", "display:none;"); } else { $('#Analysis_1_3').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_4"] == 0) { $('#Analysis_1_4').attr("style", "display:none;"); } else { $('#Analysis_1_4').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_5"] == 0) { $('#Analysis_1_5').attr("style", "display:none;"); } else { $('#Analysis_1_5').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_6"] == 0) { $('#Analysis_1_6').attr("style", "display:none;"); } else { $('#Analysis_1_6').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_7"] == 0) { $('#Analysis_1_7').attr("style", "display:none;"); } else { $('#Analysis_1_7').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_8"] == 0) { $('#Analysis_1_8').attr("style", "display:none;"); } else { $('#Analysis_1_8').attr("style", ""); }
	if (V_permission["Func_Use_Analysis_1_9"] == 0) { $('#Analysis_1_9').attr("style", "display:none;"); } else { $('#Analysis_1_9').attr("style", ""); }
	if (V_permission["Data_Use_Model_1_4"] == 0) { $('#Data_Use_Model_1_4').attr("style", "display:none;");  } else {$('#Data_Use_Model_1_4').attr("style", "");}
	
	
	if (V_permission["Func_Use_Draw_1_1"] == 0) { $('#Draw_1_1').attr("style", "display:none;"); } else { $('#Draw_1_1').attr("style", ""); }
	if (V_permission["Func_Use_Draw_1_2"] == 0) { $('#Draw_1_2').attr("style", "display:none;"); } else { $('#Draw_1_2').attr("style", ""); }
	if (V_permission["Func_Use_Draw_1_3"] == 0) { $('#Draw_1_3').attr("style", "display:none;"); } else { $('#Draw_1_3').attr("style", ""); }
	if (V_permission["Func_Use_Share_1_1"] == 0) { $('#Share_1_1').attr("style", "display:none;"); } else { $('#Share_1_1').attr("style", ""); }
	if (V_permission["Func_Use_Share_1_2"] == 0) { $('#Share_1_2').attr("style", "display:none;"); } else { $('#Share_1_2').attr("style", ""); }
	/********* 20220510 add ***********/
	// Location_w1.show();
	// // if (V_permission["Func_Use_Share_1_4"] == 0) { $('#Share_1_4').attr("style", "display:none;"); } else { $('#Share_1_4').attr("style", "");}
	// console.log(V_permission["Func_Use_Share_1_5"] )
	// if (V_permission["Func_Use_Share_1_5"] == 0) { $('#Share_1_5').attr("style", "display:none;"); } else { $('#Share_1_5').attr("style", "");}
	// if (V_permission["Func_Use_Location_1_1"] == 0) { Location_Acc.cells("a1").hide(); } else { Location_Acc.cells("a1").show(); }
	// if (V_permission["Func_Use_Location_1_3"] == 0) { Location_Acc.cells("a3").hide(); } else { Location_Acc.cells("a3").show(); }
	// if (V_permission["Func_Use_Location_1_4"] == 0) { Location_Acc.cells("a4").hide(); } else { Location_Acc.cells("a4").show(); }
	// if (V_permission["Func_Use_Location_1_5"] == 0) { Location_Acc.cells("a5").hide(); } else { Location_Acc.cells("a5").show(); }
	// if (V_permission["Func_Use_Location_1_6"] == 0) { $('#Location_1_6').attr("style", "display:none;"); } else { $('#Location_1_6').attr("style", ""); }
	// if (V_permission["Func_Use_Location_1_7"] == 0) { Location_Acc.cells("a7").hide(); } else { Location_Acc.cells("a7").show(); }


	// Location_w1.hide();
	/********* 20220510 add ***********/

	if (V_permission["Func_Use_Manage_1_1"] == 0) { $("#account_management_id").hide(); } else { $("#account_management_id").show(); }



	if (V_permission["Func_Use_Data_1_2"] == 0) { $("#data_buy").hide(); } else { $("#data_buy").show(); }

	//$('#Sup_1_2').attr("style","display:none;");
}

function unlogin_permission_set() {

	$.ajax({
	type: "POST",
	url: "php/Init_user_func.php",
	datatype: "json",
	success: function(response) {
		
		response=JSON.parse(response);	
		
		permissions_array=response.permissions;
			for(j=0;j<permissions_array.length;j++){
				
				V_permission[permissions_array[j].slug]=1;
				//alert(permissions_array[j].slug);
				}
		}
	});	
	$.ajax({
	type: "POST",
	url: "php/Init_user_view.php",
	datatype: "json",
	success: function(response) {
		
		response=JSON.parse(response);					
		permissions_array=response.permissions;
			for(j=0;j<permissions_array.length;j++){
				V_permission[permissions_array[j].slug]=1;
				}
		}
	});	
	$.ajax({
	type: "POST",
	url: "php/Init_user_download.php",
	datatype: "json",
	success: function(response) {
		response=JSON.parse(response);					
		permissions_array=response.permissions;
			for(j=0;j<permissions_array.length;j++){
				//alert(permissions_array[j].slug);
				V_permission[permissions_array[j].slug]=1;
				}
		}
	});


}
setTimeout(function () { unlogin_permission_set(); }, 3000);
function fun_un_vis(){
	setTimeout(function () { $('#Func_Use_Model_1_2').removeClass( "transition visible" );  if (V_permission["Func_Use_Model_1_2"] == 0) { $('#Func_Use_Model_1_2').attr("style", "display:none;"); } else { $('#Func_Use_Model_1_2').attr("style", ""); }}, 500);
	
}

function fun_access_log(slug) {
	//slug = "Func_Use_Analysis_1_1";
	
	
	if (Login_ID == "") {
		//url_accesslog="https://data.geodac.tw/geoinfo_api/api/anonymous/data/fun/accesslog/access/";
		url_accesslog="https://data.geodac.tw/geoinfo_api/api/anonymous/data/fun/accesslog/access/";
		$.ajax({

			url: url_accesslog + slug ,
			success: function (data) {
				console.log(slug + ':' + data.result);
			}
		})
	} else {
		
		//url_accesslog="https://data.geodac.tw/geoinfo_api/api/geodac/data/fun/accesslog/access/";
		url_accesslog="https://data.geodac.tw/geoinfo_api/api/geodac/data/fun/accesslog/access/";
		$.ajax({
			headers: {
            "authorization":"Bearer "+response_token//此處放置請求到的使用者token
			},
			//url: 'https://data.geodac.tw/geoinfo_api/api/geodac/data/geoproduct/accesslog/webview/' + layer_content.ID + '?uid=' + Login_ID,
			url: url_accesslog+ slug ,
			success: function (data) {
				
				console.log(slug + ':' + data.result);
			}
		})
	}
	
	
	
}